<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Calculadora de Asado Mejorada</title>
  <style>
    body { font-family: "Segoe UI", Arial; background:#f5f5f5; margin:0; padding:20px; }
    h1 { text-align:center; color:#b22222; }
    .card { background:#fff; padding:12px; margin:10px 0; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    input, select { padding:6px; margin:4px; border-radius:6px; border:1px solid #ccc; }
    button { padding:10px 15px; border:none; border-radius:6px; margin:5px; cursor:pointer; font-weight:bold; }
    .agregar { background:#2e8b57; color:#fff; }
    .calcular { background:#b22222; color:#fff; }
    .resultado { background:#fff; padding:15px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.15); margin-top:20px; }
    .item { padding:6px; border-bottom:1px solid #eee; }
    .debe { color:#b22222; font-weight:bold; }
    .recibe { color:#2e8b57; font-weight:bold; }
  </style>
</head>
<body>
<h1>üçñ Calculadora de Asado - Categor√≠as</h1>

<div id="personas"></div>
<button class="agregar" onclick="agregarPersona()">‚ûï Agregar persona</button>
<button class="calcular" onclick="calcular()">üìä Calcular</button>

<div id="resultado" class="resultado"></div>

<script>
let contador = 0;

function agregarPersona(){
  contador++;
  const div = document.createElement("div");
  div.className = "card";
  div.innerHTML = `
    <input id="nombre${contador}" placeholder="Nombre">
    Gast√≥: <input type="number" id="gasto${contador}" value="0" min="0">
    Categor√≠a:
    <select id="categoria${contador}">
      <option value="comida">üçñ Comida</option>
      <option value="bebida">üçª Bebida</option>
      <option value="extra">üßæ Extra</option>
    </select><br>
    Participaci√≥n:
    <label><input type="checkbox" id="come${contador}" checked> Come</label>
    <label><input type="checkbox" id="toma${contador}" checked> Toma</label>
  `;
  document.getElementById("personas").appendChild(div);
}

function calcular(){
  let personas = [];

  for(let i=1; i<=contador; i++){
    personas.push({
      nombre: document.getElementById("nombre"+i).value || "Persona "+i,
      gasto: parseFloat(document.getElementById("gasto"+i).value) || 0,
      cat: document.getElementById("categoria"+i).value,
      come: document.getElementById("come"+i).checked,
      toma: document.getElementById("toma"+i).checked
    });
  }

  if(personas.length === 0){
    document.getElementById("resultado").innerHTML = "<p>No hay datos cargados.</p>";
    return;
  }

  let totalComida = personas.filter(p=>p.cat==="comida").reduce((s,p)=>s+p.gasto,0);
  let totalBebida = personas.filter(p=>p.cat==="bebida").reduce((s,p)=>s+p.gasto,0);
  let totalExtra  = personas.filter(p=>p.cat==="extra").reduce((s,p)=>s+p.gasto,0);

  let comen = personas.filter(p=>p.come).length;
  let toman = personas.filter(p=>p.toma).length;

  let costoComida = totalComida/(comen||1);
  let costoBebida = totalBebida/(toman||1);
  let costoExtra = totalExtra/personas.length;

  let resumen = `
    <h3>Resumen</h3>
    <p><b>Total comida:</b> $${totalComida} ‚Üí $${costoComida.toFixed(2)} por persona que comi√≥</p>
    <p><b>Total bebida:</b> $${totalBebida} ‚Üí $${costoBebida.toFixed(2)} por persona que tom√≥</p>
    <p><b>Total extra:</b> $${totalExtra} ‚Üí $${costoExtra.toFixed(2)} por cada uno</p>
  `;

  let detalle = "";

  personas.forEach(p=>{
    let debe = (p.come?costoComida:0) + (p.toma?costoBebida:0) + costoExtra;
    let balance = debe - p.gasto;
    let clase = balance>0 ? "debe" : balance<0 ? "recibe" : "";

    detalle += `<div class='item'><b>${p.nombre}</b>: <span class='${clase}'>${balance>0?"Debe $"+balance.toFixed(2):balance<0?"Recibe $"+(-balance).toFixed(2):"Justo"}</span></div>`;
  });

  document.getElementById("resultado").innerHTML = resumen + detalle;
}
</script>
  <h2>Liquidaci√≥n entre personas</h2>
  <div id="settlements" class="mt-4 p-3 border rounded bg-gray-50 text-sm"></div>

</body>
</html>
